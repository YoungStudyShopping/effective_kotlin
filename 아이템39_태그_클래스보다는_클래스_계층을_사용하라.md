
## 아이템 39: 태그 클래스보다는 클래스 계층을 사용하라

- 큰 규모의 프로젝트에서는 상수(constant) ‘모드’를 가진 클래스를 꽤 많이 볼 수 있습니다. 이러한 상수 모드를 태그(tag)라고 부르며, 태그를 포함한 클래스를 태그 클래스(tagged class)라고 부릅니다. 그런데 태그 클래스는 다양한 문제를 내포하고 있습니다. 이러한 문제는서로 다른 책임을 한 클래스에 태그로 구분해서 넣는다는 것에서 시작합니다.
- 태그 클래스를 사용한 경우, 단점
  - 한 클래스에 여러 모드를처리하기 위한 상용구(boilerplate)가 추가됩니다.
  - 여러 목적으로 사용해야 하므로 프로퍼티가 일관적이지 않게 사용될 수 있 으며, 더 많은 프로퍼티가 필요합니다. 예를 들어 위의 예제에서 value는 모드가 LIST_EMPTY 또는 LIST_NOT_EMPTY일 때 아예 사용되지도 않습니다.
  - 요소가 여러 목적을 가지고, 요소를 여러 방법으로 설정할 수 있는 경우에는 상태의 일관성과 정확성을 지키기 어렵습니다.
  - 팩토리 메서드를 사용해야 하는 경우가 많습니다. 그렇지 않으면 객체가 제대로 생성되었는지 확인하는 것 자체가 굉장히 어렵습니다.

- 코틀린은 그래서 일반적으로 태그 클래스보다 sealed 클래스를 많이 사용합니다. ==> **책임이 분산되므로 훨씬 깔끔**

<br>

### sealed 한정자

- sealed 한정자는 외부 파일에서 서브클래스를 만드는 행위 자체를 모두 제한합니다.
- 외부에서 추가적인 서브클래스를 만들 수 없으므로, 타입이 추가되지 않을 거라는 게 보장됩니다.
- when을 사용할 때 else 브랜치를 따로 만들 필요가 없습니다. when구문에서 이를 처리하는 것을 잊어버리기 않을 수도 있습니다.
- sealed 한정자를 사용하면, 확장 함수를 사용해서 클래스에 새로운 함수를 추가하거나, 클래스의 다양한 변경을 쉽게 처리할 수 있습니다.
- abstract 클래스는 계층에 새로운 클래스를 추가할 수 있는 여지를 남깁니다. 클래스의 서브 클래스를 제어하려면, sealed 한정자를 사용해야 합니다. abstract는 상속과 관련된 설계를 할 때 사용합니다.

<br>

### 태그 클래스와 상태 패턴의 차이

- 태그 클래스와 상태 패턴(state pattern)을 혼동하면 안됩니다. 상태 패턴은 객 체의 내부 상태가 변화할 때, 객체의 동작이 변하는 소프트웨어 디자인 패턴입니다.
- 상태 패턴을 시용한다면, 서로 다른 상태를 나타내는 클래스 계층 구조를 만들 게 됩니다. 그리고 현재 상태를 나타내기 위한 읽고 쓸 수 있는 프로퍼티도 만들게 됩니다.

<br>

### 정리

코틀린에서는 태그 클래스보다 타입 계층을 사용하는 것이 좋습니다. 그리고 일반적으로 이러한 타입 계층을 만들 때는 sealed 클래스를 사용합니다. 이는 상태 패턴과는 다릅니다. 타입 계층과 상태 패턴은 실질적으로 함께 사용하는 협력 관계라고 할 수 있습니다. 


<br>